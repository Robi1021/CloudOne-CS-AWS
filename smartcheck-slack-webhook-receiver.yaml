apiVersion: v1
kind: Service
metadata:
  name: scantoslack
  labels:
     name: scantoslack
spec:
  ports:
  - port: 80
    targetPort: 8088
  selector:
    name: scantoslack
---
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: scantoslack
  labels:
    name: scantoslack
spec:
  replicas: 1
  template:
    metadata:
      labels:
        name: scantoslack
    spec:
      containers:
      - name: scantoslack
        image: 517003314933.dkr.ecr.eu-central-1.amazonaws.com/scantoslack:latest
        args:
        - --frontend-url=will be generated by this script
        - --slack-text=_Image Scan Alert Details_
        - --slack-url=SLACK_URL="https://hooks.slack.com/services/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"
        - --slack-channel=smartcheck-slack-webhook-receiver.yaml
        ports:
        - name: scantoslack
          containerPort: 8088
        imagePullPolicy: IfNotPresent
      restartPolicy: Always
